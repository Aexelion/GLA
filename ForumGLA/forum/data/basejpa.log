/*C3*/SET SCHEMA PUBLIC
drop table Messages if exists
drop table Threads if exists
drop table Description if exists
drop table Utilisateurs if exists
create table Utilisateurs (id bigint GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null, login varchar(255) not null, password varchar(255) not null, PRIMARY KEY(login))
create table Threads (id bigint GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1)  not null, sujet varchar(255), auteur varchar(255) not null, reponse int, vues int, PRIMARY KEY(id), FOREIGN KEY(auteur) REFERENCES Utilisateurs(login))
create table Messages (id bigint GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null, id_discussion bigint not null, auteur varchar(255), texte varchar(4096), PRIMARY KEY (id), FOREIGN KEY (id_discussion) REFERENCES Threads(id))
create table Description (id bigint GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) not null, pseudo varchar(255), nom varchar(255), prenom varchar(255), age int, description varchar(4096), PRIMARY KEY (id), FOREIGN KEY (pseudo) REFERENCES Utilisateurs(login))
INSERT INTO UTILISATEURS VALUES(1,'admin','admin')
COMMIT
INSERT INTO UTILISATEURS VALUES(2,'pierre','pierre')
COMMIT
INSERT INTO UTILISATEURS VALUES(3,'jose','jose')
COMMIT
INSERT INTO UTILISATEURS VALUES(4,'paul','paul')
COMMIT
INSERT INTO UTILISATEURS VALUES(5,'jacques','jacques')
COMMIT
INSERT INTO THREADS VALUES(1,'SUJET IMPORTANT','admin',0,4242)
COMMIT
INSERT INTO THREADS VALUES(2,'Sujet n\u00b02','pierre',0,150)
COMMIT
INSERT INTO MESSAGES VALUES(1,1,'admin','Message Test')
COMMIT
INSERT INTO MESSAGES VALUES(2,2,'pierre','Message test aussi')
COMMIT
INSERT INTO UTILISATEURS VALUES(6,'Test','azertyuiop')
COMMIT
INSERT INTO THREADS VALUES(3,'azertyuiop','Test',-1,0)
COMMIT
INSERT INTO MESSAGES VALUES(3,3,'Test','azertyuiop')
COMMIT
DELETE FROM THREADS WHERE ID=3
INSERT INTO THREADS VALUES(3,'azertyuiop','Test',0,0)
COMMIT
